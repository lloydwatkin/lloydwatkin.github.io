---
layout: slides
title: 'Building silo-free realtime applications'
description: 'Building silo-free realtime web-based applications using XMPP'
theme: simple
---

<style>
.silo-bg body {
    background-image: url('/nodeconf-london-oneshot/images/silo.jpg');
    background-size: cover;
}
.silo-bg body h1, .children-bg body h1, .why-bg body h1, .internet-bg body h1, .xmpp-bg body h1 {
    background-color: rgba(255,255,255,0.7);
    padding: 10px 0 50px 0;
}
    
.silo-bg body h2, .internet-bg body h2, .buddycloud-bg body h2, .git-bg body h2 {
    background-color: rgba(255,255,255,0.7);
    padding: 5px 0 20px 0;
}
.children-bg body {
    background-image: url('/nodeconf-london-oneshot/images/think-of-the-children.jpg');
    background-size: cover;
}
.why-bg body {
    background-image: url('/nodeconf-london-oneshot/images/banksy.jpg');
    background-size: contain;
}
.xmpp-bg body {
    background-image: url('/nodeconf-london-oneshot/images/xmpp.png');
    background-size: contain;
}
.internet-bg body {
    background-image: url('/nodeconf-london-oneshot/images/the-internet.jpg');
    background-size: contain;
}
.whatif-bg body {
    background-image: url('/nodeconf-london-oneshot/images/what-if.jpg');
    background-size: contain;
}
.buddycloud-bg body {
    background-image: url('/nodeconf-london-oneshot/images/buddycloud.png');
    background-size: contain;
}
.git-bg body {
    background-image: url('/nodeconf-london-oneshot/images/git.jpg');
    background-size: contain;
}
h1.reverse-text {
    color: #ffffff;
    background-color: #000000;
    padding-bottom: 40px;
}
</style>
<div class="slides">
    
    <section data-state="silo-bg">
        <h1>Silo-free federated realtime applications</h1>
        <h2><a href="https://twitter.com/lloydwatkin">@lloydwatkin</a></h2>
    </section>
    
    <section>
        
        <section>
        <h1>Why silo-free applications?</h1>
        </section>
        <section>
        <h1>Why federated applications?</h1>
        </section>
    
    </section>
        
    <section>
        <section>
        <h1>Why don't we see more of these?</h1>
        </section>
        
        <section>
            <h2>Its hard!</h2>
            <h2>Companies often lean on these technologies, grow big, make their apis properietary</h2>
            <aside class="notes">
            <ul>
                <li>Ulimately you won't be running the software</li>
                <li>You need to be tolerant of environment, old versions</li>
                <li>This isn't a problem in a centralized environment</li>
                <li>You can't/its hard to mine user data for "free" applications</li>
                <li>You can't show someone adverts on their own systems</li>
                <li>Retrieving data from a remote systems is slower</li>
            </ul>
            </aside>
        </section>
    </section>
    <section>
        <section data-state="xmpp-bg">
        <h1>XMPP</h1>
        <aside class="notes">
        <ul>
        <li>eXtensible Messaging and Presence Protocol (aka Jabber)</li>
        <li>Started in 1998, at a time of ICQ, AOLIM, Y! Messenger</li>
        <li>Lots of different accounts</li>
        <li>Part of the IETF</li>
        <li>Set of standards documented for all to use</li>
        </ul>
        </aside>
        </section>
        <section>
        <h2>Standards? Yawn!</h2><br/>
        <blockquote>"When they succeed, they dramatically lower the cost of creating something." TBL</blockquote>
        <aside class="notes">
        When developing new software, e.g. to deliver content, thanks to HTTP no one needs to develop methods of achieving this    
        </aside>
        </section>
        <section>
            <h2>Does anyone use it?</h2><br/>
            <ul>
                <li>Google: GCM</li>
                <li>Facebook: Chat interface</li>
                <li>Whatsapp: Hacked version</li>
                <li>Atlassian: HipChat</li>
            </ul><br/><br/>
            <h2>Its usage isn't often advertised</h2>
            <aside class="notes">
            Banking, military
            </aside>
        </section>
        <section>
            <h2>What is it used for?</h2><br/>
            <ul>
            <li>Chat applications - duh!</li>
            <li>Publish-subscribe systems - push!</li>
            <li>Social networks</li>
            <li>Internet of Things</li>
            <li>Secure messaging</li>
            <li>Signalling for WebRTC</li>
            </ul>
        </section>
    </section>
    
<section name="fundamentals">
        
        <section name="fundamentals-title>">
        <h1>Fundamentals</h1>
        </section>
        
        <section name="fundamental-stanzas">
        <h1 class="xmpp-blue">Stanzas</h1>
        <h3 class="xmpp-green">...are snippets of XML</h3>
        <br/>
        <p class="xmpp-orange">There are three types:<br/>
            &lt;message/&gt;, &lt;presence/&gt;, &amp; &lt;iq/&gt;</p>
        <aside class="notes">
           <p>XML streams eventually form a valid XML document</p>
           <p>Message types, 'chat', 'groupchat', 'headline'</p>
           <p>Presence - like your online status (online, busy, away, etc)</p>
           <p>IQ (information query): GET/SET,  RESULT/ERROR - like basic HTTP verbs</p>
       </aside>
        </section>

         <section>
            <h2>The <abbr title="Jabber ID">JID</abbr></h2>
            <br/>
            <h3>[<span class="xmpp-orange">user</span>@] <span class="xmpp-blue">example.org</span> [/<span class="xmpp-green">mobile-phone</span>]</h3>
            <br/>
            
            <ul>
                <li><span class="xmpp-orange">local</span>: The user/device (i.e. client)</li>
                <li><span class="xmpp-blue">domain</span>: Server you are addressing</li>
                <li><span class="xmpp-green">resource</span>: Multiple connections?</li>
            </ul>
            <aside class="notes">
            <h3>Always designed with multiple devices in mind</h3>
            <h3>Each device has a priority - route to the most 'available'</h3>
        </section>
        
        <section>
            
            <h1>Clients</h1><br/>
            
            <h3 class="xmpp-orange">Thin clients, leave the work to the server</h3>
            <h3 class="xmpp-blue">Connect over TCP/BOSH (Long polling)/WebSockets</h3>
            <h3 class="xmpp-green">Data is pushed to clients, clients push data</h3>
        
        </section>
             
        <section>
            
            <h1>Servers</h1><br/>
            
            <h3 class="xmpp-orange">Routes messages</h3>
            <h3 class="xmpp-blue">Allow users to talk across servers</h3>
            <h3 class="xmpp-green">Handles authentication and security</h3>
        
        </section> 
             
        <section>
            <h1>Components</h1><br/>
            
            <h3 class="xmpp-orange">Provide extended functionality</h3>
            
            <h3 class="xmpp-blue">Can send messages on behalf of clients</h3>
            <h3 class="xmpp-green">Server + language agnostic</h3>
        
        </section> 
    
    </section>
    
    <section>
        <section>
            <h1>Working with XMPP in nodejs</h1>
            <aside class="notes">
            <ul>
            <li>nodejs very appropriate tool for XMPP</li>
            <li>asynchronus / evented / streams all very useful</li>
            </ul>
            </aside>
        </section>
        <section>
            <h1><a href="http://node-xmpp.github.io/doc/nodexmppclient.html">node-xmpp-client</a></h1><br/>
            <pre class="javascript"><code>
            var Client = require('node-xmpp-client')
            var client = new Client({ /* options */ })
            
            client.on('online', console.log.bind)
            client.on('stanza', function(stanza) {
                stanza.attrs.to = stanza.attrs.to
                delete stanza.attrs.from
                client.send(stanza)
            })
            </code></pre>
            <aside class="notes">
            <ul>
               <li>Create a client connection</li>
               <li>Can also be used from a browser (BOSH, websocket)</li>
               <li>Build chat bots, implement custom logic in a client</li>
            </ul>
            </aside>
        </section>
        <section>
                <h2><a href="https://github.com/node-xmpp/node-xmpp-component">node-xmpp-component</a></h2><br/>
                <ul>
                    <li>Build components</li>
                    <li>Implement your own business logic</li>
                    <li>Send messages as local users</li>
                </ul>
                <aside class="notes">
                <ul>
                    <li>Components exist on a subdomain of the XMPP server</li>
                    <li>Implement your own custom business logic</li>
                    <li>You can send stanzas as local users</li>
                    <li>Transferrable to any XMPP server you decide to use</li>
                </ul>
                </aside>
        </section>
        <section>
                <h2><a href="https://github.com/node-xmpp/node-xmpp-server">node-xmpp-server</a></h2><br/>
                <h3>Not ready as a full XMPP server, but you can start up and connect clients to handle job management and messaging</h3>
        </section>
        <section>
            <h1><a href="https://xmpp-ftw.jit.su">XMPP-FTW</a></h1><br/>
            
            <h2>Powerful XMPP; Simple JSON</h2>
            <aside class="notes">
            <ul>
            <li>Designed to be a client side library</li>
            <li>Translates messages back and fore between XML and JSON</li>
            <li>Evented</li>
            <li>But perfectly useable purely server side to make building federated applications *really* simple</li>
            </ul>
            </aside>
        </section>
    </section>
    
    <section>
        <section data-state="whatif-bg">
            &nbsp;
        </section>
        
        <section data-state="buddycloud-bg">
            <h2>...we built a social network where users control their data, never fearing about it going away?</h2>
        </section>
        
        <section data-state="git-bg">
            <h2>...we built git hosting where I fork to my own server so whatever asshat is attacking github doesn't stop us all from coding?</h2>
        </section>
    
    
    </section>
    
    <section>
        <section>
        <h1 class="xmpp-green">♫ HEY ♫</h1>
        <h2 class="xmpp-blue">I just met you...</h2>
        <aside class="notes">
        ...finally...
        I'd like to offer anyone help trying to build this sort of application
        and they say to finish on a song... so...
        </aside>
        </section>
        <section>
        <h1 class="xmpp-orange">...and this is crazy...</h1>
        </section>
        <section>
        <h2 class="xmpp-green">♫ ..but here's my JID... ♫</h2><br/>
        <h2 class="xmpp-blue"><strong>lloyd@evilprofessor.co.uk</strong></h2><br/>
        <h2 class="xmpp-orange">♫ I.M. me maybe ♫</h2>
        </section>
    </section>
    
    <section name="questions">

        <h3>Slides available @ <a href="http://talks.evilprofessor.co.uk/nodeconf-london-oneshot/">http://talks.evilprofessor.co.uk/nodeconf-london-oneshot/</a></h3><br/>
        <h3>Get your own federated social network like *so* fast:<br/><a href="https://hosting.buddycloud.com">hosting.buddycloud.com</a></h3><br/>
        <h3>@lloydwatkin</h3>
    </section>
</div>
